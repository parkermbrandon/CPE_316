#include "ExternalDAC.h"

extern const uint16_t sine_wave[769] = {
    1861, 1876, 1891, 1907, 1922, 1937, 1952, 1967, 1983, 1998, 2013, 2028, 2043, 2058, 2073, 2089,
    2104, 2119, 2134, 2149, 2164, 2179, 2194, 2209, 2224, 2238, 2253, 2268, 2283, 2298, 2313, 2327,
    2342, 2357, 2371, 2386, 2401, 2415, 2430, 2444, 2458, 2473, 2487, 2501, 2516, 2530, 2544, 2558,
    2572, 2586, 2600, 2614, 2628, 2642, 2656, 2669, 2683, 2697, 2710, 2724, 2737, 2751, 2764, 2777,
    2790, 2804, 2817, 2830, 2843, 2855, 2868, 2881, 2894, 2906, 2919, 2931, 2944, 2956, 2968, 2981,
    2993, 3005, 3017, 3029, 3040, 3052, 3064, 3075, 3087, 3098, 3109, 3121, 3132, 3143, 3154, 3165,
    3176, 3186, 3197, 3207, 3218, 3228, 3239, 3249, 3259, 3269, 3279, 3289, 3298, 3308, 3317, 3327,
    3336, 3345, 3354, 3363, 3372, 3381, 3390, 3399, 3407, 3415, 3424, 3432, 3440, 3448, 3456, 3464,
    3471, 3479, 3486, 3494, 3501, 3508, 3515, 3522, 3529, 3536, 3542, 3549, 3555, 3561, 3567, 3573,
    3579, 3585, 3591, 3596, 3602, 3607, 3612, 3617, 3622, 3627, 3632, 3636, 3641, 3645, 3650, 3654,
    3658, 3662, 3665, 3669, 3673, 3676, 3679, 3683, 3686, 3689, 3691, 3694, 3697, 3699, 3701, 3704,
    3706, 3708, 3709, 3711, 3713, 3714, 3715, 3717, 3718, 3719, 3720, 3720, 3721, 3721, 3722, 3722,
    3722, 3722, 3722, 3722, 3721, 3721, 3720, 3719, 3718, 3717, 3716, 3715, 3713, 3712, 3710, 3709,
    3707, 3705, 3702, 3700, 3698, 3695, 3693, 3690, 3687, 3684, 3681, 3678, 3674, 3671, 3667, 3664,
    3660, 3656, 3652, 3647, 3643, 3639, 3634, 3630, 3625, 3620, 3615, 3610, 3604, 3599, 3593, 3588,
    3582, 3576, 3570, 3564, 3558, 3552, 3545, 3539, 3532, 3526, 3519, 3512, 3505, 3497, 3490, 3483,
    3475, 3468, 3460, 3452, 3444, 3436, 3428, 3420, 3411, 3403, 3394, 3386, 3377, 3368, 3359, 3350,
    3341, 3331, 3322, 3313, 3303, 3293, 3284, 3274, 3264, 3254, 3244, 3233, 3223, 3213, 3202, 3192,
    3181, 3170, 3159, 3148, 3137, 3126, 3115, 3104, 3092, 3081, 3069, 3058, 3046, 3034, 3023, 3011,
    2999, 2987, 2974, 2962, 2950, 2938, 2925, 2913, 2900, 2887, 2875, 2862, 2849, 2836, 2823, 2810,
    2797, 2784, 2771, 2757, 2744, 2731, 2717, 2704, 2690, 2676, 2663, 2649, 2635, 2621, 2607, 2593,
    2579, 2565, 2551, 2537, 2523, 2509, 2494, 2480, 2466, 2451, 2437, 2422, 2408, 2393, 2379, 2364,
    2349, 2335, 2320, 2305, 2290, 2276, 2261, 2246, 2231, 2216, 2201, 2186, 2171, 2156, 2141, 2126,
    2111, 2096, 2081, 2066, 2051, 2036, 2020, 2005, 1990, 1975, 1960, 1945, 1929, 1914, 1899, 1884,
    1869, 1853, 1838, 1823, 1808, 1793, 1777, 1762, 1747, 1732, 1717, 1702, 1686, 1671, 1656, 1641,
    1626, 1611, 1596, 1581, 1566, 1551, 1536, 1521, 1506, 1491, 1476, 1461, 1446, 1432, 1417, 1402,
    1387, 1373, 1358, 1343, 1329, 1314, 1300, 1285, 1271, 1256, 1242, 1228, 1213, 1199, 1185, 1171,
    1157, 1143, 1129, 1115, 1101, 1087, 1073, 1059, 1046, 1032, 1018, 1005, 991, 978, 965, 951,
    938, 925, 912, 899, 886, 873, 860, 847, 835, 822, 809, 797, 784, 772, 760, 748,
    735, 723, 711, 699, 688, 676, 664, 653, 641, 630, 618, 607, 596, 585, 574, 563,
    552, 541, 530, 520, 509, 499, 489, 478, 468, 458, 448, 438, 429, 419, 409, 400,
    391, 381, 372, 363, 354, 345, 336, 328, 319, 311, 302, 294, 286, 278, 270, 262,
    254, 247, 239, 232, 225, 217, 210, 203, 196, 190, 183, 177, 170, 164, 158, 152,
    146, 140, 134, 129, 123, 118, 112, 107, 102, 97, 92, 88, 83, 79, 75, 70,
    66, 62, 58, 55, 51, 48, 44, 41, 38, 35, 32, 29, 27, 24, 22, 20,
    17, 15, 13, 12, 10, 9, 7, 6, 5, 4, 3, 2, 1, 1, 0, 0,
    0, 0, 0, 0, 1, 1, 2, 2, 3, 4, 5, 7, 8, 9, 11, 13,
    14, 16, 18, 21, 23, 25, 28, 31, 33, 36, 39, 43, 46, 49, 53, 57,
    60, 64, 68, 72, 77, 81, 86, 90, 95, 100, 105, 110, 115, 120, 126, 131,
    137, 143, 149, 155, 161, 167, 173, 180, 186, 193, 200, 207, 214, 221, 228, 236,
    243, 251, 258, 266, 274, 282, 290, 298, 307, 315, 323, 332, 341, 350, 359, 368,
    377, 386, 395, 405, 414, 424, 433, 443, 453, 463, 473, 483, 494, 504, 515, 525,
    536, 546, 557, 568, 579, 590, 601, 613, 624, 635, 647, 658, 670, 682, 693, 705,
    717, 729, 741, 754, 766, 778, 791, 803, 816, 828, 841, 854, 867, 879, 892, 905,
    918, 932, 945, 958, 971, 985, 998, 1012, 1025, 1039, 1053, 1066, 1080, 1094, 1108, 1122,
    1136, 1150, 1164, 1178, 1192, 1206, 1221, 1235, 1249, 1264, 1278, 1292, 1307, 1321, 1336, 1351,
    1365, 1380, 1395, 1409, 1424, 1439, 1454, 1469, 1484, 1498, 1513, 1528, 1543, 1558, 1573, 1588,
    1603, 1618, 1633, 1649, 1664, 1679, 1694, 1709, 1724, 1739, 1755, 1770, 1785, 1800, 1815, 1831,
    1846,
};
extern const uint16_t square_wave[769] = {
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722, 3722,
    3722, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861, 1861,
    1861,
};
extern const uint16_t sawtooth_wave[769] = {
    1861, 1863, 1866, 1868, 1871, 1873, 1876, 1878, 1880, 1883, 1885, 1888, 1890, 1892, 1895, 1897,
    1900, 1902, 1905, 1907, 1909, 1912, 1914, 1917, 1919, 1922, 1924, 1926, 1929, 1931, 1934, 1936,
    1938, 1941, 1943, 1946, 1948, 1951, 1953, 1955, 1958, 1960, 1963, 1965, 1967, 1970, 1972, 1975,
    1977, 1980, 1982, 1984, 1987, 1989, 1992, 1994, 1997, 1999, 2001, 2004, 2006, 2009, 2011, 2013,
    2016, 2018, 2021, 2023, 2026, 2028, 2030, 2033, 2035, 2038, 2040, 2043, 2045, 2047, 2050, 2052,
    2055, 2057, 2059, 2062, 2064, 2067, 2069, 2072, 2074, 2076, 2079, 2081, 2084, 2086, 2088, 2091,
    2093, 2096, 2098, 2101, 2103, 2105, 2108, 2110, 2113, 2115, 2118, 2120, 2122, 2125, 2127, 2130,
    2132, 2134, 2137, 2139, 2142, 2144, 2147, 2149, 2151, 2154, 2156, 2159, 2161, 2164, 2166, 2168,
    2171, 2173, 2176, 2178, 2180, 2183, 2185, 2188, 2190, 2193, 2195, 2197, 2200, 2202, 2205, 2207,
    2209, 2212, 2214, 2217, 2219, 2222, 2224, 2226, 2229, 2231, 2234, 2236, 2239, 2241, 2243, 2246,
    2248, 2251, 2253, 2255, 2258, 2260, 2263, 2265, 2268, 2270, 2272, 2275, 2277, 2280, 2282, 2285,
    2287, 2289, 2292, 2294, 2297, 2299, 2301, 2304, 2306, 2309, 2311, 2314, 2316, 2318, 2321, 2323,
    2326, 2328, 2330, 2333, 2335, 2338, 2340, 2343, 2345, 2347, 2350, 2352, 2355, 2357, 2360, 2362,
    2364, 2367, 2369, 2372, 2374, 2376, 2379, 2381, 2384, 2386, 2389, 2391, 2393, 2396, 2398, 2401,
    2403, 2406, 2408, 2410, 2413, 2415, 2418, 2420, 2422, 2425, 2427, 2430, 2432, 2435, 2437, 2439,
    2442, 2444, 2447, 2449, 2451, 2454, 2456, 2459, 2461, 2464, 2466, 2468, 2471, 2473, 2476, 2478,
    2481, 2483, 2485, 2488, 2490, 2493, 2495, 2497, 2500, 2502, 2505, 2507, 2510, 2512, 2514, 2517,
    2519, 2522, 2524, 2527, 2529, 2531, 2534, 2536, 2539, 2541, 2543, 2546, 2548, 2551, 2553, 2556,
    2558, 2560, 2563, 2565, 2568, 2570, 2572, 2575, 2577, 2580, 2582, 2585, 2587, 2589, 2592, 2594,
    2597, 2599, 2602, 2604, 2606, 2609, 2611, 2614, 2616, 2618, 2621, 2623, 2626, 2628, 2631, 2633,
    2635, 2638, 2640, 2643, 2645, 2648, 2650, 2652, 2655, 2657, 2660, 2662, 2664, 2667, 2669, 2672,
    2674, 2677, 2679, 2681, 2684, 2686, 2689, 2691, 2693, 2696, 2698, 2701, 2703, 2706, 2708, 2710,
    2713, 2715, 2718, 2720, 2723, 2725, 2727, 2730, 2732, 2735, 2737, 2739, 2742, 2744, 2747, 2749,
    2752, 2754, 2756, 2759, 2761, 2764, 2766, 2769, 2771, 2773, 2776, 2778, 2781, 2783, 2785, 2788,
    2790, 2793, 2795, 2798, 2800, 2802, 2805, 2807, 2810, 2812, 2814, 2817, 2819, 2822, 2824, 2827,
    2829, 2831, 2834, 2836, 2839, 2841, 2844, 2846, 2848, 2851, 2853, 2856, 2858, 2860, 2863, 2865,
    2868, 2870, 2873, 2875, 2877, 2880, 2882, 2885, 2887, 2890, 2892, 2894, 2897, 2899, 2902, 2904,
    2906, 2909, 2911, 2914, 2916, 2919, 2921, 2923, 2926, 2928, 2931, 2933, 2935, 2938, 2940, 2943,
    2945, 2948, 2950, 2952, 2955, 2957, 2960, 2962, 2965, 2967, 2969, 2972, 2974, 2977, 2979, 2981,
    2984, 2986, 2989, 2991, 2994, 2996, 2998, 3001, 3003, 3006, 3008, 3011, 3013, 3015, 3018, 3020,
    3023, 3025, 3027, 3030, 3032, 3035, 3037, 3040, 3042, 3044, 3047, 3049, 3052, 3054, 3056, 3059,
    3061, 3064, 3066, 3069, 3071, 3073, 3076, 3078, 3081, 3083, 3086, 3088, 3090, 3093, 3095, 3098,
    3100, 3102, 3105, 3107, 3110, 3112, 3115, 3117, 3119, 3122, 3124, 3127, 3129, 3132, 3134, 3136,
    3139, 3141, 3144, 3146, 3148, 3151, 3153, 3156, 3158, 3161, 3163, 3165, 3168, 3170, 3173, 3175,
    3177, 3180, 3182, 3185, 3187, 3190, 3192, 3194, 3197, 3199, 3202, 3204, 3207, 3209, 3211, 3214,
    3216, 3219, 3221, 3223, 3226, 3228, 3231, 3233, 3236, 3238, 3240, 3243, 3245, 3248, 3250, 3253,
    3255, 3257, 3260, 3262, 3265, 3267, 3269, 3272, 3274, 3277, 3279, 3282, 3284, 3286, 3289, 3291,
    3294, 3296, 3298, 3301, 3303, 3306, 3308, 3311, 3313, 3315, 3318, 3320, 3323, 3325, 3328, 3330,
    3332, 3335, 3337, 3340, 3342, 3344, 3347, 3349, 3352, 3354, 3357, 3359, 3361, 3364, 3366, 3369,
    3371, 3374, 3376, 3378, 3381, 3383, 3386, 3388, 3390, 3393, 3395, 3398, 3400, 3403, 3405, 3407,
    3410, 3412, 3415, 3417, 3419, 3422, 3424, 3427, 3429, 3432, 3434, 3436, 3439, 3441, 3444, 3446,
    3449, 3451, 3453, 3456, 3458, 3461, 3463, 3465, 3468, 3470, 3473, 3475, 3478, 3480, 3482, 3485,
    3487, 3490, 3492, 3495, 3497, 3499, 3502, 3504, 3507, 3509, 3511, 3514, 3516, 3519, 3521, 3524,
    3526, 3528, 3531, 3533, 3536, 3538, 3540, 3543, 3545, 3548, 3550, 3553, 3555, 3557, 3560, 3562,
    3565, 3567, 3570, 3572, 3574, 3577, 3579, 3582, 3584, 3586, 3589, 3591, 3594, 3596, 3599, 3601,
    3603, 3606, 3608, 3611, 3613, 3616, 3618, 3620, 3623, 3625, 3628, 3630, 3632, 3635, 3637, 3640,
    3642, 3645, 3647, 3649, 3652, 3654, 3657, 3659, 3661, 3664, 3666, 3669, 3671, 3674, 3676, 3678,
    3681, 3683, 3686, 3688, 3691, 3693, 3695, 3698, 3700, 3703, 3705, 3707, 3710, 3712, 3715, 3717,
    3720,
};
extern const uint16_t triangle_wave[769] = {
    1861, 1866, 1871, 1876, 1880, 1885, 1890, 1895, 1900, 1905, 1909, 1914, 1919, 1924, 1929, 1934,
    1938, 1943, 1948, 1953, 1958, 1963, 1967, 1972, 1977, 1982, 1987, 1992, 1997, 2001, 2006, 2011,
    2016, 2021, 2026, 2030, 2035, 2040, 2045, 2050, 2055, 2059, 2064, 2069, 2074, 2079, 2084, 2088,
    2093, 2098, 2103, 2108, 2113, 2118, 2122, 2127, 2132, 2137, 2142, 2147, 2151, 2156, 2161, 2166,
    2171, 2176, 2180, 2185, 2190, 2195, 2200, 2205, 2209, 2214, 2219, 2224, 2229, 2234, 2239, 2243,
    2248, 2253, 2258, 2263, 2268, 2272, 2277, 2282, 2287, 2292, 2297, 2301, 2306, 2311, 2316, 2321,
    2326, 2330, 2335, 2340, 2345, 2350, 2355, 2360, 2364, 2369, 2374, 2379, 2384, 2389, 2393, 2398,
    2403, 2408, 2413, 2418, 2422, 2427, 2432, 2437, 2442, 2447, 2451, 2456, 2461, 2466, 2471, 2476,
    2481, 2485, 2490, 2495, 2500, 2505, 2510, 2514, 2519, 2524, 2529, 2534, 2539, 2543, 2548, 2553,
    2558, 2563, 2568, 2572, 2577, 2582, 2587, 2592, 2597, 2602, 2606, 2611, 2616, 2621, 2626, 2631,
    2635, 2640, 2645, 2650, 2655, 2660, 2664, 2669, 2674, 2679, 2684, 2689, 2693, 2698, 2703, 2708,
    2713, 2718, 2723, 2727, 2732, 2737, 2742, 2747, 2752, 2756, 2761, 2766, 2771, 2776, 2781, 2785,
    2790, 2795, 2800, 2805, 2810, 2814, 2819, 2824, 2829, 2834, 2839, 2844, 2848, 2853, 2858, 2863,
    2868, 2873, 2877, 2882, 2887, 2892, 2897, 2902, 2906, 2911, 2916, 2921, 2926, 2931, 2935, 2940,
    2945, 2950, 2955, 2960, 2965, 2969, 2974, 2979, 2984, 2989, 2994, 2998, 3003, 3008, 3013, 3018,
    3023, 3027, 3032, 3037, 3042, 3047, 3052, 3056, 3061, 3066, 3071, 3076, 3081, 3086, 3090, 3095,
    3100, 3105, 3110, 3115, 3119, 3124, 3129, 3134, 3139, 3144, 3148, 3153, 3158, 3163, 3168, 3173,
    3177, 3182, 3187, 3192, 3197, 3202, 3207, 3211, 3216, 3221, 3226, 3231, 3236, 3240, 3245, 3250,
    3255, 3260, 3265, 3269, 3274, 3279, 3284, 3289, 3294, 3298, 3303, 3308, 3313, 3318, 3323, 3328,
    3332, 3337, 3342, 3347, 3352, 3357, 3361, 3366, 3371, 3376, 3381, 3386, 3390, 3395, 3400, 3405,
    3410, 3415, 3419, 3424, 3429, 3434, 3439, 3444, 3449, 3453, 3458, 3463, 3468, 3473, 3478, 3482,
    3487, 3492, 3497, 3502, 3507, 3511, 3516, 3521, 3526, 3531, 3536, 3540, 3545, 3550, 3555, 3560,
    3565, 3570, 3574, 3579, 3584, 3589, 3594, 3599, 3603, 3608, 3613, 3618, 3623, 3628, 3632, 3637,
    3642, 3647, 3652, 3657, 3661, 3666, 3671, 3676, 3681, 3686, 3691, 3695, 3700, 3705, 3710, 3715,
    3720, 3720, 3715, 3710, 3705, 3700, 3695, 3691, 3686, 3681, 3676, 3671, 3666, 3661, 3657, 3652,
    3647, 3642, 3637, 3632, 3628, 3623, 3618, 3613, 3608, 3603, 3599, 3594, 3589, 3584, 3579, 3574,
    3570, 3565, 3560, 3555, 3550, 3545, 3540, 3536, 3531, 3526, 3521, 3516, 3511, 3507, 3502, 3497,
    3492, 3487, 3482, 3478, 3473, 3468, 3463, 3458, 3453, 3449, 3444, 3439, 3434, 3429, 3424, 3419,
    3415, 3410, 3405, 3400, 3395, 3390, 3386, 3381, 3376, 3371, 3366, 3361, 3357, 3352, 3347, 3342,
    3337, 3332, 3328, 3323, 3318, 3313, 3308, 3303, 3298, 3294, 3289, 3284, 3279, 3274, 3269, 3265,
    3260, 3255, 3250, 3245, 3240, 3236, 3231, 3226, 3221, 3216, 3211, 3207, 3202, 3197, 3192, 3187,
    3182, 3177, 3173, 3168, 3163, 3158, 3153, 3148, 3144, 3139, 3134, 3129, 3124, 3119, 3115, 3110,
    3105, 3100, 3095, 3090, 3086, 3081, 3076, 3071, 3066, 3061, 3056, 3052, 3047, 3042, 3037, 3032,
    3027, 3023, 3018, 3013, 3008, 3003, 2998, 2994, 2989, 2984, 2979, 2974, 2969, 2965, 2960, 2955,
    2950, 2945, 2940, 2935, 2931, 2926, 2921, 2916, 2911, 2906, 2902, 2897, 2892, 2887, 2882, 2877,
    2873, 2868, 2863, 2858, 2853, 2848, 2844, 2839, 2834, 2829, 2824, 2819, 2814, 2810, 2805, 2800,
    2795, 2790, 2785, 2781, 2776, 2771, 2766, 2761, 2756, 2752, 2747, 2742, 2737, 2732, 2727, 2723,
    2718, 2713, 2708, 2703, 2698, 2693, 2689, 2684, 2679, 2674, 2669, 2664, 2660, 2655, 2650, 2645,
    2640, 2635, 2631, 2626, 2621, 2616, 2611, 2606, 2602, 2597, 2592, 2587, 2582, 2577, 2572, 2568,
    2563, 2558, 2553, 2548, 2543, 2539, 2534, 2529, 2524, 2519, 2514, 2510, 2505, 2500, 2495, 2490,
    2485, 2481, 2476, 2471, 2466, 2461, 2456, 2451, 2447, 2442, 2437, 2432, 2427, 2422, 2418, 2413,
    2408, 2403, 2398, 2393, 2389, 2384, 2379, 2374, 2369, 2364, 2360, 2355, 2350, 2345, 2340, 2335,
    2330, 2326, 2321, 2316, 2311, 2306, 2301, 2297, 2292, 2287, 2282, 2277, 2272, 2268, 2263, 2258,
    2253, 2248, 2243, 2239, 2234, 2229, 2224, 2219, 2214, 2209, 2205, 2200, 2195, 2190, 2185, 2180,
    2176, 2171, 2166, 2161, 2156, 2151, 2147, 2142, 2137, 2132, 2127, 2122, 2118, 2113, 2108, 2103,
    2098, 2093, 2088, 2084, 2079, 2074, 2069, 2064, 2059, 2055, 2050, 2045, 2040, 2035, 2030, 2026,
    2021, 2016, 2011, 2006, 2001, 1997, 1992, 1987, 1982, 1977, 1972, 1967, 1963, 1958, 1953, 1948,
    1943, 1938, 1934, 1929, 1924, 1919, 1914, 1909, 1905, 1900, 1895, 1890, 1885, 1880, 1876, 1871,
    1866,
};
External_DAC::External_DAC() {

}

External_DAC::~External_DAC() {
}

void External_DAC::DAC_init(void)
{
    RCC->AHB2ENR |= RCC_AHB2ENR_GPIOAEN;
    GPIOA->MODER &= ~(GPIO_MODER_MODE4 | GPIO_MODER_MODE5 | GPIO_MODER_MODE6 | GPIO_MODER_MODE7);
    GPIOA->MODER |= (GPIO_MODER_MODE4_1 | GPIO_MODER_MODE5_1 | GPIO_MODER_MODE6_1 | GPIO_MODER_MODE7_1);
    GPIOA->AFR[0] &= ~(GPIO_AFRL_AFSEL4 | GPIO_AFRL_AFSEL5 | GPIO_AFRL_AFSEL6 | GPIO_AFRL_AFSEL7);
    GPIOA->AFR[0] |= ((5 << GPIO_AFRL_AFSEL4_Pos) | (5 << GPIO_AFRL_AFSEL5_Pos) | (5 << GPIO_AFRL_AFSEL6_Pos) | (5 << GPIO_AFRL_AFSEL7_Pos));
    GPIOA->OTYPER &= ~(GPIO_OTYPER_OT4 | GPIO_OTYPER_OT5 | GPIO_OTYPER_OT6 | GPIO_OTYPER_OT7);
    GPIOA->PUPDR &= ~(GPIO_PUPDR_PUPD4 | GPIO_PUPDR_PUPD5 | GPIO_PUPDR_PUPD6 | GPIO_PUPDR_PUPD7);
    RCC->APB2ENR |= RCC_APB2ENR_SPI1EN;
    SPI1->CR1 = SPI_CR1_MSTR | SPI_CR1_BR_1;  // Set prescaler to fPCLK/4
    SPI1->CR2 = SPI_CR2_SSOE | SPI_CR2_NSSP | (0xF << SPI_CR2_DS_Pos);
    SPI1->CR1 |= SPI_CR1_SPE;
}

// Convert a voltage value into a 12-bit value to control the DAC
uint16_t External_DAC::DAC_mvolt_convert(float mvoltage)
{
	return (mvoltage * 4095) / 3300;
}

void External_DAC::DAC_write(uint16_t value_A, uint16_t value_B)
//void External_DAC::DAC_write(uint16_t value_A)
{
    uint16_t spi_data_A = (value_A & 0x0FFF) | 0x3000;  // For DACA
    uint16_t spi_data_B = (value_B & 0x0FFF) | 0xB000;  // For DACB

    // Write to DACA
    while(!(SPI1->SR & SPI_SR_TXE));
    SPI1->DR = spi_data_A;

    // Write to DACB
    while(!(SPI1->SR & SPI_SR_TXE));
    SPI1->DR = spi_data_B;
}


/* Matlab script for generating lookup tables
% Parameters
fs = 256;  % Sampling frequency
t = 0:1/fs:1-1/fs;  % Time vector
Vref = 3.3;  % Reference voltage
bit_depth = 4095;  % 12-bit DAC
dc_offset = 1.5;  % DC offset in volts
Vpp = 3.0;  % Peak-to-peak voltage in volts

% Scaling factors
scale_factor = bit_depth / Vref;
dc_offset_scaled = round(dc_offset * scale_factor);
amplitude_scaled = round((Vpp / 2) * scale_factor);

% Generate Sine Wave
sine_wave = round(dc_offset_scaled + amplitude_scaled * sin(2 * pi * t));

% Generate Square Wave
square_wave = round(dc_offset_scaled + amplitude_scaled * (square(2 * pi * t) + 1) / 2);

% Generate Triangle Wave
triangle_wave = round(dc_offset_scaled + amplitude_scaled * (sawtooth(2 * pi * t, 0.5) + 1) / 2);

% Generate Sawtooth Wave
sawtooth_wave = round(dc_offset_scaled + amplitude_scaled * (sawtooth(2 * pi * t) + 1) / 2);

% Print Lookup Tables
print_lookup_table('sine_wave', sine_wave);
print_lookup_table('square_wave', square_wave);
print_lookup_table('sawtooth_wave', sawtooth_wave);
print_lookup_table('triangle_wave', triangle_wave);

% Function to print lookup table in 16x16 format
function print_lookup_table(name, data)
    fprintf('extern const uint16_t %s[%d] = {\n', name, length(data));
    for i = 1:16:length(data)
        fprintf('    ');
        fprintf('%d, ', data(i:min(i+15, end)));
        fprintf('\n');
    end
    fprintf('};\n');
end
 */




